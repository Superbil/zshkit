
# Set xterm/screen titles. These should run as hooks
case $TERM in 
  (*xterm*|ansi)
    function title {
      print -Pn "\e]1;$*\a"
      print -Pn "\e]2;$*\a"
    }
  ;;
  (screen)
    # normal escape codes don't work here.
    function title { }
  ;;
esac

TITLE_FMT="%n@%m: %~"
title $TITLE_FMT

# Available hook functions (see zshmisc(1))
#  * chpwd: exec when working dir changes
#  * precmd: execute before each prompt
#  * preexec: execute after a command has been read and is about to be run

function chpwd {
  title $TITLE_FMT
}

function precmd {
  title $TITLE_FMT
}

function preexec {
  emulate -L zsh
    local -a cmd; cmd=(${(z)1})
    title $cmd[1]:t "$cmd[2,-1]"
}
